<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trolley Dilemma Deneyi</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5; color: #222;
      min-height: 100vh; display: flex;
      align-items: center; justify-content: center; padding: 20px;
    }
    .ekran {
      display: none; background: #fff; border-radius: 12px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.10);
      padding: 40px 48px; max-width: 820px; width: 100%;
    }
    .ekran.aktif { display: block; }

    /* Bystander Ã¶ncesi/sonrasÄ±: sabit yÃ¼kseklik â€” layout hiÃ§ deÄŸiÅŸmez */
    #ekran-bystander-once,
    #ekran-bystander-sonra {
      min-height: 640px;
      display: none;
      flex-direction: column;
    }
    #ekran-bystander-once.aktif,
    #ekran-bystander-sonra.aktif {
      display: flex;
    }

    /* GÃ¶rsel alanÄ± esnetilir, kart boyutu deÄŸiÅŸmez */
    .gorsel-sahne {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 16px;
      min-height: 380px;
    }
    .gorsel-sahne img {
      max-width: 100%; max-height: 380px;
      border-radius: 10px; border: 2px solid #e5e7eb;
      object-fit: contain;
      transition: opacity 0.15s ease;
    }
    .gorsel-sahne img.gecis { opacity: 0; }

    #ekran-aktor .gorsel-sahne { flex: none; min-height: auto; margin-bottom: 24px; }
    #ekran-aktor .gorsel-sahne img { max-height: 420px; }

    h1 { font-size:1.8rem; margin-bottom:12px; color:#1a1a2e; }
    h2 { font-size:1.3rem; margin-bottom:20px; color:#16213e; }
    p  { line-height:1.7; margin-bottom:12px; color:#444; }
    .bilgi-kutusu { background:#eef2ff; border-left:4px solid #4f46e5; border-radius:6px; padding:14px 18px; margin-bottom:20px; font-size:0.95rem; }
    .btn { display:inline-block; padding:12px 28px; border:none; border-radius:8px; font-size:1rem; cursor:pointer; transition:background 0.2s,transform 0.1s; }
    .btn:active { transform:scale(0.97); }
    .btn-primary { background:#4f46e5; color:#fff; }
    .btn-primary:hover { background:#4338ca; }
    .btn-gray { background:#e5e7eb; color:#333; }
    .btn-gray:hover { background:#d1d5db; }
    .btn:disabled { opacity:0.5; cursor:not-allowed; }
    .btn-satir { margin-top:28px; display:flex; gap:12px; justify-content:flex-end; flex-wrap:wrap; }
    .form-grup { margin-bottom:22px; }
    .form-grup label { display:block; font-weight:600; margin-bottom:8px; font-size:0.95rem; }
    .form-grup input[type="text"], .form-grup input[type="number"], .form-grup select {
      width:100%; padding:10px 14px; border:1.5px solid #d1d5db;
      border-radius:7px; font-size:0.95rem; outline:none; transition:border 0.2s;
    }
    .form-grup input:focus, .form-grup select:focus { border-color:#4f46e5; }
    .likert-grup { margin-bottom:26px; }
    .likert-grup .soru-metni { font-size:0.95rem; margin-bottom:10px; font-weight:500; }
    .likert-secenekler { display:flex; gap:6px; align-items:center; flex-wrap:nowrap; }
    .likert-secenekler .uc-label { font-size:0.72rem; color:#777; white-space:nowrap; }
    .likert-secenekler .radio-grup { display:flex; gap:4px; flex:1; justify-content:center; }
    .likert-secenekler input[type="radio"] { display:none; }
    .likert-secenekler label.radio-label {
      width:34px; height:34px; border:2px solid #d1d5db; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-size:0.82rem; font-weight:700; cursor:pointer; transition:all 0.15s; color:#555; flex-shrink:0;
    }
    .likert-secenekler input[type="radio"]:checked + label.radio-label { background:#4f46e5; border-color:#4f46e5; color:#fff; }
    .likert-secenekler label.radio-label:hover { border-color:#4f46e5; color:#4f46e5; }
    .bolum-bant { background:#1a1a2e; color:#fff; border-radius:8px; padding:12px 20px; margin-bottom:24px; display:flex; align-items:center; gap:12px; flex-shrink:0; }
    .bolum-bant .bolum-no { background:#4f46e5; border-radius:50%; width:32px; height:32px; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:0.95rem; flex-shrink:0; }
    .hata { color:#dc2626; font-size:0.85rem; margin-top:6px; display:none; }
    .spinner { width:48px; height:48px; border:5px solid #e5e7eb; border-top-color:#4f46e5; border-radius:50%; animation:spin 0.9s linear infinite; margin:20px auto; }
    @keyframes spin { to { transform:rotate(360deg); } }
    @media (max-width:600px) { .ekran { padding:24px 18px; } .likert-secenekler { flex-wrap:wrap; } }
    .gges-madde { display:flex; align-items:center; gap:16px; padding:14px 0; border-bottom:1px solid #f3f4f6; }
    .gges-madde:last-child { border-bottom:none; }
    .gges-sifat { font-weight:700; font-size:1rem; color:#1a1a2e; min-width:100px; flex-shrink:0; }
    .gges-secenekler { display:flex; flex-wrap:nowrap; gap:6px; flex:1; }
    .gges-radio-label { display:flex; align-items:center; gap:4px; cursor:pointer; padding:6px 10px; border:2px solid #d1d5db; border-radius:8px; font-size:0.78rem; color:#444; transition:all 0.15s; background:#fff; user-select:none; white-space:nowrap; flex:1; justify-content:center; }
    .gges-radio-label input[type="radio"] { display:none; }
    .gges-radio-label:hover { border-color:#4f46e5; color:#4f46e5; background:#eef2ff; }
    .gges-radio-label:has(input:checked) { border-color:#4f46e5; background:#4f46e5; color:#fff; }
    @media (max-width:700px) { .gges-madde { flex-direction:column; align-items:flex-start; } .gges-secenekler { flex-wrap:wrap; } }
    .ilerleme-kap { background:#e5e7eb; border-radius:999px; height:8px; margin-bottom:8px; overflow:hidden; flex-shrink:0; }
    .ilerleme-ic { background:#4f46e5; height:100%; border-radius:999px; transition:width 0.4s ease; }
    .ilerleme-metin { font-size:0.82rem; color:#888; text-align:right; margin-bottom:12px; flex-shrink:0; }
    .tus-alani { display:flex; gap:16px; justify-content:center; margin:20px 0; }
    .tus-kutu { border:3px solid #d1d5db; border-radius:12px; padding:20px 40px; text-align:center; min-width:160px; user-select:none; pointer-events:none; }
    .tus-kutu.secildi { border-color:#4f46e5; background:#eef2ff; }
    .tus-harf { font-size:2.2rem; font-weight:900; display:block; margin-bottom:6px; color:#1a1a2e; }
    .tus-aciklama { font-size:0.9rem; color:#555; font-weight:600; }
    .klavye-ipucu { text-align:center; font-size:0.82rem; color:#aaa; margin-top:8px; }

    /* FÄ°XATÄ°ON CROSS */
    .fixation-ekran {
      display:none; position:fixed; inset:0;
      background:#fff; align-items:center; justify-content:center; z-index:9999;
    }
    .fixation-ekran.aktif { display:flex; }
    .fixation-cross { font-size:5rem; font-weight:300; color:#222; line-height:1; user-select:none; }

    /* BYSTANDER LÄ°KERT */
    .bys-soru { font-size:1rem; font-weight:600; color:#1a1a2e; margin-bottom:20px; text-align:center; flex-shrink:0; }
    .bys-likert-dis { pointer-events:none; user-select:none; display:flex; justify-content:center; flex-shrink:0; }
    .bys-likert-ic { display:inline-flex; flex-direction:column; align-items:stretch; gap:8px; }
    .bys-sayilar-satir { display:flex; align-items:center; gap:12px; }
    .bys-numara {
      width:52px; height:52px; border:3px solid #d1d5db; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-size:1.1rem; font-weight:800; color:#555; transition:all 0.15s; flex-shrink:0;
    }
    .bys-numara.secildi { background:#4f46e5; border-color:#4f46e5; color:#fff; }
    .bys-etiket-satir { display:flex; justify-content:space-between; font-size:0.72rem; color:#888; }
    .bys-klavye-ipucu { text-align:center; font-size:0.82rem; color:#aaa; margin-top:12px; flex-shrink:0; }
  </style>
</head>
<body>

<!-- FÄ°XATÄ°ON CROSS -->
<div class="fixation-ekran" id="fixation-ekran">
  <span class="fixation-cross">+</span>
</div>

<!-- EKRAN 0: KARÅILAMA -->
<section id="ekran-hosgeldin" class="ekran aktif">
  <h1>Trolley Problemi Deneyi</h1>
  <div class="bilgi-kutusu">Bu Ã§alÄ±ÅŸma, ahlaki karar verme sÃ¼reÃ§lerini incelemek amacÄ±yla tasarlanmÄ±ÅŸ bir psikoloji deneyidir.</div>
  <p>Ã‡alÄ±ÅŸmaya katÄ±lÄ±m <strong>gÃ¶nÃ¼llÃ¼lÃ¼k esasÄ±na</strong> dayanmaktadÄ±r. Verilen yanÄ±tlar tamamen anonim tutulacak ve yalnÄ±zca bilimsel amaÃ§larla kullanÄ±lacaktÄ±r.</p>
  <p>Deneyi istediÄŸiniz herhangi bir aÅŸamada sonlandÄ±rabilirsiniz. Tahmini tamamlanma sÃ¼resi <strong>15-20 dakikadÄ±r</strong>.</p>
  <p>Devam ederek aydÄ±nlatÄ±lmÄ±ÅŸ onam formunu kabul etmiÅŸ sayÄ±lÄ±rsÄ±nÄ±z.</p>
  <div class="btn-satir"><button class="btn btn-primary" onclick="ekranGec('ekran-demografik')">BaÅŸla â†’</button></div>
</section>

<!-- EKRAN 1: DEMOGRAFÄ°K -->
<section id="ekran-demografik" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">1</div><div>Demografik Bilgiler</div></div>
  <div class="form-grup"><label>1. Bir takma isim giriniz</label><input type="text" id="dem-takma-isim" placeholder="Takma isminizi yazÄ±n" /></div>
  <div class="form-grup"><label>2. YaÅŸÄ±nÄ±z</label><input type="number" id="dem-yas" min="18" max="99" placeholder="Ã–rn: 24" /></div>
  <div class="form-grup"><label>3. Cinsiyetiniz</label>
    <select id="dem-cinsiyet"><option value="">-- SeÃ§iniz --</option><option>Erkek</option><option>KadÄ±n</option><option>Belirtmek istemiyorum</option></select>
  </div>
  <div class="form-grup"><label>4. Gelir Durumunuz</label>
    <select id="dem-gelir"><option value="">-- SeÃ§iniz --</option><option>0 - 17.000 â‚º</option><option>17.000 - 35.000 â‚º</option><option>35.000 - 57.000 â‚º</option><option>57.000 â‚º ve Ã¼stÃ¼</option></select>
  </div>
  <div class="form-grup"><label>5. Dini Ä°nancÄ±nÄ±z</label>
    <select id="dem-din"><option value="">-- SeÃ§iniz --</option><option>Hristiyan</option><option>Budist</option><option>Hindu</option><option>MÃ¼slÃ¼man</option><option>Yahudi</option><option>Ateist</option><option>Deist</option><option>Agnostik</option><option>DiÄŸer</option></select>
  </div>
  <div class="form-grup"><label>6. Kendinizi hangi dÃ¼zeyde dindar olarak gÃ¶rÃ¼yorsunuz?</label>
    <select id="dem-dindarlik"><option value="">-- SeÃ§iniz --</option><option>Dindar deÄŸilim</option><option>Biraz dindarÄ±m</option><option>Orta derecede dindarÄ±m</option><option>Ã‡ok dindarÄ±m</option><option>Bilmiyorum</option></select>
  </div>
  <div class="form-grup">
    <label>7. Siyasi aÃ§Ä±dan TÃ¼rkiye'de yÄ±llardÄ±r sol, saÄŸ ve merkez diye bir siyasi gelenek vardÄ±r. Siz kendinizi aÅŸaÄŸÄ±daki Ã¶lÃ§ekte hangi konumda gÃ¶rÃ¼yorsunuz?</label>
    <div class="likert-grup" style="margin-top:10px;">
      <div class="likert-secenekler">
        <span class="uc-label">AÅŸÄ±rÄ± Sol</span>
        <div class="radio-grup" id="dem-siyasi-konum-rg"></div>
        <span class="uc-label">AÅŸÄ±rÄ± SaÄŸ</span>
      </div>
    </div>
  </div>
  <div class="form-grup"><label>8. Kendinizi siyasi gÃ¶rÃ¼ÅŸÃ¼nÃ¼ze hangi dÃ¼zeyde baÄŸlÄ± olarak gÃ¶rÃ¼yorsunuz?</label>
    <select id="dem-siyasi-baglilik"><option value="">-- SeÃ§iniz --</option><option>HiÃ§ baÄŸlÄ± deÄŸilim</option><option>Az baÄŸlÄ±yÄ±m</option><option>Orta dÃ¼zeyde baÄŸlÄ±yÄ±m</option><option>OldukÃ§a baÄŸlÄ±yÄ±m</option><option>Tamamen baÄŸlÄ±yÄ±m</option></select>
  </div>
  <div id="dem-hata" class="hata">LÃ¼tfen tÃ¼m alanlarÄ± doldurun.</div>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-hosgeldin')">â† Geri</button>
    <button class="btn btn-primary" onclick="demografikDogrula()">Devam â†’</button>
  </div>
</section>

<!-- EKRAN 2a: KÄ°MLÄ°K AÃ‡IKLAMA -->
<section id="ekran-kimlik-aciklama" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">2</div><div>Kimlik KaynaÅŸÄ±m Ã–lÃ§eÄŸi</div></div>
  <p>Birazdan gÃ¶receÄŸiniz sorularÄ±n doÄŸru cevabÄ± yoktur. LÃ¼tfen ekranda gÃ¶receÄŸiniz sorularÄ± kendi bakÄ±ÅŸ aÃ§Ä±nÄ±za gÃ¶re mÃ¼mkÃ¼n olduÄŸunca objektif bir biÃ§imde cevaplayÄ±nÄ±z.</p>
  <p style="margin-top:16px; font-weight:600; font-size:1.05rem; color:#1a1a2e;">BaÄŸlÄ± bulunduÄŸunuz grubu TÃ¼rklÃ¼k Ã¼zerinden tanÄ±mladÄ±ÄŸÄ±nÄ±zda;</p>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-demografik')">â† Geri</button>
    <button class="btn btn-primary" onclick="ekranGec('ekran-kimlik')">Devam â†’</button>
  </div>
</section>

<!-- EKRAN 2b: KÄ°MLÄ°K -->
<section id="ekran-kimlik" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">2</div><div>Kimlik KaynaÅŸÄ±m Ã–lÃ§eÄŸi</div></div>
  <p class="bilgi-kutusu">AÅŸaÄŸÄ±daki ifadelerin sizin iÃ§in ne kadar doÄŸru olduÄŸunu 1 (Kesinlikle KatÄ±lmÄ±yorum) ile 7 (Kesinlikle KatÄ±lÄ±yorum) arasÄ±nda deÄŸerlendirin.</p>
  <div id="kimlik-sorular"></div>
  <div id="kimlik-hata" class="hata">LÃ¼tfen tÃ¼m sorularÄ± yanÄ±tlayÄ±n.</div>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-kimlik-aciklama')">â† Geri</button>
    <button class="btn btn-primary" onclick="kimlikDogrula()">Devam â†’</button>
  </div>
</section>

<!-- EKRAN 3a: GGES AÃ‡IKLAMA -->
<section id="ekran-gges-aciklama" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">3</div><div>GGES Ã–lÃ§eÄŸi</div></div>
  <p>AÅŸaÄŸÄ±da TÃ¼rk ve TÃ¼rk olmayan insanlarla ilgili birtakÄ±m sÄ±fatlar yer almaktadÄ±r.</p>
  <p style="margin-top:12px;">SorularÄ±n doÄŸru veya yanlÄ±ÅŸ cevabÄ± yoktur, bizim iÃ§in Ã¶nemli olan sizin ne dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼nÃ¼zdÃ¼r.</p>
  <p style="margin-top:12px;">LÃ¼tfen <strong>1 (HiÃ§ tanÄ±mlamÄ±yor)</strong> ile <strong>5 (Tamamen tanÄ±mlÄ±yor)</strong> arasÄ±nda her sÄ±fatÄ±n <strong>TÃ¼rk</strong> ve <strong>TÃ¼rk olmayan</strong> grubu ne kadar iyi tanÄ±mladÄ±ÄŸÄ±nÄ± iÅŸaretleyiniz.</p>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-kimlik')">â† Geri</button>
    <button class="btn btn-primary" onclick="ekranGec('ekran-gges-turk')">Devam â†’</button>
  </div>
</section>

<!-- EKRAN 3b: GGES TÃœRK -->
<section id="ekran-gges-turk" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">3</div><div>GGES Ã–lÃ§eÄŸi â€“ TÃ¼rk Gruplar</div></div>
  <p class="bilgi-kutusu">1 = HiÃ§ tanÄ±mlamÄ±yor &nbsp;Â·&nbsp; 5 = Tamamen tanÄ±mlÄ±yor</p>
  <p style="margin-bottom:20px; font-weight:600; font-size:1.05rem; color:#1a1a2e;">TÃ¼rk gruplar iÃ§in;</p>
  <div id="gges-turk-sorular"></div>
  <div id="gges-turk-hata" class="hata">LÃ¼tfen tÃ¼m sorularÄ± yanÄ±tlayÄ±n.</div>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-gges-aciklama')">â† Geri</button>
    <button class="btn btn-primary" onclick="ggesTogrula()">Devam â†’</button>
  </div>
</section>

<!-- EKRAN 3c: GGES TÃœRK OLMAYAN -->
<section id="ekran-gges-to" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">3</div><div>GGES Ã–lÃ§eÄŸi â€“ TÃ¼rk Olmayan Gruplar</div></div>
  <p class="bilgi-kutusu">1 = HiÃ§ tanÄ±mlamÄ±yor &nbsp;Â·&nbsp; 5 = Tamamen tanÄ±mlÄ±yor</p>
  <p style="margin-bottom:20px; font-weight:600; font-size:1.05rem; color:#1a1a2e;">TÃ¼rk olmayan gruplar iÃ§in;</p>
  <div id="gges-to-sorular"></div>
  <div id="gges-to-hata" class="hata">LÃ¼tfen tÃ¼m sorularÄ± yanÄ±tlayÄ±n.</div>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-gges-turk')">â† Geri</button>
    <button class="btn btn-primary" onclick="ggesToOgrula()">Devam â†’</button>
  </div>
</section>

<!-- EKRAN 4a: AKTÃ–R AÃ‡IKLAMA -->
<section id="ekran-aktor-aciklama" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">4</div><div>AktÃ¶r SenaryolarÄ±</div></div>
  <p>Birazdan size bir dizi senaryo gÃ¶sterilecektir. Her senaryoda bir karar vermeniz gerekecektir.</p>
  <p style="margin-top:12px;">KararÄ±nÄ±zÄ± klavyenizdeki <strong>D</strong> veya <strong>K</strong> tuÅŸuyla belirteceksiniz.</p>
  <p style="margin-top:12px;">Her senaryo en fazla <strong>8 saniye</strong> ekranda kalacaktÄ±r.</p>
  <p style="margin-top:12px; font-style:italic; color:#666;">LÃ¼tfen yalnÄ±zca klavye tuÅŸlarÄ±nÄ± kullanÄ±n.</p>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-gges-to')">â† Geri</button>
    <button class="btn btn-primary" onclick="aktorBaslat()">BaÅŸla â†’</button>
  </div>
</section>

<!-- EKRAN 4b: AKTÃ–R -->
<section id="ekran-aktor" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">4</div><div>AktÃ¶r SenaryolarÄ±</div></div>
  <div class="ilerleme-metin" id="aktor-ilerleme-metin"></div>
  <div class="ilerleme-kap"><div class="ilerleme-ic" id="aktor-ilerleme-ic" style="width:0%"></div></div>
  <div style="display:none"><div id="geri-sayim-cubuk"></div><div id="geri-sayim-sayi"></div></div>
  <div class="gorsel-sahne"><img id="aktor-gorsel" src="" alt="Senaryo gÃ¶rseli" /></div>
  <div class="tus-alani">
    <div class="tus-kutu" id="tus-d"><span class="tus-harf">D</span><span class="tus-aciklama" id="tus-d-label">Ã‡ekerim</span></div>
    <div class="tus-kutu" id="tus-k"><span class="tus-harf">K</span><span class="tus-aciklama" id="tus-k-label">Ã‡ekmem</span></div>
  </div>
  <p class="klavye-ipucu">YalnÄ±zca klavye ile D veya K tuÅŸuna basÄ±n.</p>
</section>

<!-- EKRAN 5a: BYSTANDER AÃ‡IKLAMA -->
<section id="ekran-bystander-aciklama" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">5</div><div>Bystander SenaryolarÄ±</div></div>
  <p>Birazdan size bir dizi senaryo gÃ¶sterilecektir. Her senaryo iki aÅŸamadan oluÅŸmaktadÄ±r.</p>
  <p style="margin-top:12px;">Ä°lk aÅŸamada raylarda kimlerin olduÄŸunu gÃ¶receksiniz. Bu gÃ¶rsel birkaÃ§ saniye ekranda kalacak ve otomatik olarak geÃ§ecektir.</p>
  <p style="margin-top:12px;">Ä°kinci aÅŸamada senaryonun sonucunu gÃ¶recek ve <strong>verilen kararÄ± ne kadar ahlaki bulduÄŸunuzu</strong> klavyenizdeki <strong>1â€“6</strong> tuÅŸlarÄ±ndan birine basarak deÄŸerlendireceksiniz.</p>
  <div class="btn-satir">
    <button class="btn btn-gray" onclick="ekranGec('ekran-aktor-aciklama')">â† Geri</button>
    <button class="btn btn-primary" onclick="bystanderBaslat()">BaÅŸla â†’</button>
  </div>
</section>

<!-- EKRAN 5b: BYSTANDER Ã–NCESÄ° -->
<section id="ekran-bystander-once" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">5</div><div>Bystander SenaryolarÄ±</div></div>
  <div class="ilerleme-metin" id="bys-ilerleme-metin"></div>
  <div class="ilerleme-kap"><div class="ilerleme-ic" id="bys-ilerleme-ic" style="width:0%"></div></div>
  <div class="gorsel-sahne">
    <img id="bys-gorsel-once" src="" alt="Senaryo Ã¶ncesi" />
  </div>
</section>

<!-- EKRAN 5c: BYSTANDER SONRASI + LÄ°KERT -->
<section id="ekran-bystander-sonra" class="ekran">
  <div class="bolum-bant"><div class="bolum-no">5</div><div>Bystander SenaryolarÄ±</div></div>
  <div class="gorsel-sahne">
    <img id="bys-gorsel-sonra" src="" alt="Senaryo sonrasÄ±" />
  </div>
  <p class="bys-soru">Bu senaryoda verilen kararÄ± ne kadar ahlaki buldunuz?</p>
  <div class="bys-likert-dis">
    <div class="bys-likert-ic">
      <div class="bys-sayilar-satir">
        <div class="bys-numara" id="bys-n-1">1</div>
        <div class="bys-numara" id="bys-n-2">2</div>
        <div class="bys-numara" id="bys-n-3">3</div>
        <div class="bys-numara" id="bys-n-4">4</div>
        <div class="bys-numara" id="bys-n-5">5</div>
        <div class="bys-numara" id="bys-n-6">6</div>
      </div>
      <div class="bys-etiket-satir">
        <span>HiÃ§ ahlaki deÄŸil</span>
        <span>Tamamen ahlaki</span>
      </div>
    </div>
  </div>
  <p class="bys-klavye-ipucu">Klavyeden 1, 2, 3, 4, 5 veya 6 tuÅŸuna basÄ±n.</p>
</section>

<!-- GÃ–NDERÄ°M -->
<section id="ekran-gonderim" class="ekran">
  <h2 style="text-align:center;">Verileriniz gÃ¶nderiliyorâ€¦</h2>
  <div class="spinner"></div>
  <p style="text-align:center; color:#555;">LÃ¼tfen bu sayfayÄ± kapatmayÄ±n.</p>
</section>

<!-- BÄ°TÄ°Å -->
<section id="ekran-bitis" class="ekran">
  <h1>TeÅŸekkÃ¼rler! ğŸ‰</h1>
  <p>KatÄ±lÄ±mÄ±nÄ±z iÃ§in teÅŸekkÃ¼r ederiz. YanÄ±tlarÄ±nÄ±z baÅŸarÄ±yla kaydedildi.</p>
</section>

<script>
const GOOGLE_SCRIPT_URL   = "https://script.google.com/macros/s/BURAYA_URL_GIRIN/exec";
const AKTOR_SURE          = 8;
const BYSTANDER_ONCE_SURE = 4000;
const FIXATION_SURE       = 250;

const KIMLIK_SORULARI = [
  { id:"kimlik_1", metin:"Grubumla bir bÃ¼tÃ¼nÃ¼m." },
  { id:"kimlik_2", metin:"Grubumla bÃ¼tÃ¼nleÅŸmiÅŸ hissediyorum." },
  { id:"kimlik_3", metin:"Grubumla aramda derin bir duygusal baÄŸÄ±m var." },
  { id:"kimlik_4", metin:"Grubum ben demektir." },
  { id:"kimlik_5", metin:"Grubum iÃ§in diÄŸer grup Ã¼yelerinin yapacaÄŸÄ±ndan daha fazlasÄ±nÄ± yaparÄ±m." },
  { id:"kimlik_6", metin:"Grubum sayesinde gÃ¼Ã§lÃ¼yÃ¼m." },
  { id:"kimlik_7", metin:"BaÄŸlÄ± bulunduÄŸum grubu gÃ¼Ã§lÃ¼ hale getiriyorum." },
];
const GGES_SORULARI = [
  { id:"gges_1", metin:"Ä°yi" },   { id:"gges_2", metin:"Nazik" },
  { id:"gges_3", metin:"DÃ¼rÃ¼st" },{ id:"gges_4", metin:"GÃ¼venilir" },
  { id:"gges_5", metin:"Aksi" },  { id:"gges_6", metin:"Kaba" },
  { id:"gges_7", metin:"GÃ¼venilmez" },{ id:"gges_8", metin:"KÃ¶tÃ¼" },
];
const AKTOR_SENARYOLARI = [
  { id:"A1", gorsel:"Aktorsenaryo1.png", mapping:"DK" },
  { id:"A2", gorsel:"Aktorsenaryo2.png", mapping:"DK" },
  { id:"A3", gorsel:"Aktorsenaryo3.png", mapping:"DK" },
  { id:"A4", gorsel:"Aktorsenaryo4.png", mapping:"KD" },
  { id:"A5", gorsel:"Aktorsenaryo5.png", mapping:"KD" },
  { id:"A6", gorsel:"Aktorsenaryo6.png", mapping:"KD" },
];
const BYSTANDER_SENARYOLARI = [
  { id:"B1",  once:"Bystandergorsel1.png",  sonra:"Bystandergorsel1_1.png"   },
  { id:"B2",  once:"Bystandergorsel2.png",  sonra:"Bystandergorsel2_2.png"   },
  { id:"B3",  once:"Bystandergorsel3.png",  sonra:"Bystandergorsel3_3.png"   },
  { id:"B4",  once:"Bystandergorsel4.png",  sonra:"Bystandergorsel4_4.png"   },
  { id:"B5",  once:"Bystandergorsel5.png",  sonra:"Bystandergorsel5_5.png"   },
  { id:"B6",  once:"Bystandergorsel6.png",  sonra:"Bystandergorsel6_6.png"   },
  { id:"B7",  once:"Bystandergorsel7.png",  sonra:"Bystandergorsel7_7.png"   },
  { id:"B8",  once:"Bystandergorsel8.png",  sonra:"Bystandergorsel8_8.png"   },
  { id:"B9",  once:"Bystandergorsel9.png",  sonra:"Bystandergorsel9_9.png"   },
  { id:"B10", once:"Bystandergorsel10.png", sonra:"Bystandergorsel10_10.png" },
  { id:"B11", once:"Bystandergorsel11.png", sonra:"Bystandergorsel11_11.png" },
  { id:"B12", once:"Bystandergorsel12.png", sonra:"Bystandergorsel12_12.png" },
];

let veri = {};
let aktorSira=[], aktorIndex=0, aktorYanitVerildi=false;
let aktorTimerId=null, aktorIntervalId=null, aktorBaslangicZamani=0;
let bystanderSira=[], bystanderIndex=0;
let bystanderOncesiAktif=false, bystanderSonrasiAktif=false, bystanderTimerId=null;

function ekranGec(id) {
  document.querySelectorAll('.ekran').forEach(e => e.classList.remove('aktif'));
  document.getElementById(id).classList.add('aktif');
  window.scrollTo({ top:0, behavior:'smooth' });
}

// Fixation cross gÃ¶ster â†’ arka planda gÃ¶rsel yÃ¼kle â†’ ekranÄ± deÄŸiÅŸtir â†’ fade-in
function fixationGoster(sonrakiId, gorselEl, gorselSrc, callback) {
  const fix = document.getElementById('fixation-ekran');
  fix.classList.add('aktif');

  gorselEl.classList.add('gecis');
  gorselEl.src = gorselSrc;

  const doGecis = () => {
    document.querySelectorAll('.ekran').forEach(e => e.classList.remove('aktif'));
    document.getElementById(sonrakiId).classList.add('aktif');
    window.scrollTo({ top:0, behavior:'instant' });
    setTimeout(() => {
      fix.classList.remove('aktif');
      gorselEl.classList.remove('gecis');
      if (callback) callback();
    }, 50);
  };

  if (gorselEl.complete && gorselEl.naturalWidth > 0) {
    setTimeout(doGecis, FIXATION_SURE);
  } else {
    let done = false;
    const tid = setTimeout(() => { if (!done) { done=true; doGecis(); } }, FIXATION_SURE);
    gorselEl.onload = () => { if (!done) { done=true; clearTimeout(tid); doGecis(); } };
  }
}

function karistir(arr) {
  const a=[...arr];
  for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}
  return a;
}
function likertRadioUret(cid,isim,max=6){
  const el=document.getElementById(cid); if(!el)return; el.innerHTML='';
  for(let i=1;i<=max;i++) el.innerHTML+=`<input type="radio" name="${isim}" id="${isim}_${i}" value="${i}"/><label class="radio-label" for="${isim}_${i}">${i}</label>`;
}
function likertDegerOku(isim){ const s=document.querySelector(`input[name="${isim}"]:checked`); return s?parseInt(s.value):null; }
function olcekUret(cid,sorular,isim,max=6){
  const el=document.getElementById(cid); el.innerHTML='';
  sorular.forEach(s=>{
    el.innerHTML+=`<div class="likert-grup"><div class="soru-metni">${s.metin}</div><div class="likert-secenekler"><span class="uc-label">Kesinlikle KatÄ±lmÄ±yorum</span><div class="radio-grup" id="rg_${s.id}"></div><span class="uc-label">Kesinlikle KatÄ±lÄ±yorum</span></div></div>`;
    likertRadioUret(`rg_${s.id}`,s.id,max);
  });
}
function olcekVeriTopla(sorular){
  const r={};
  for(const s of sorular){const d=likertDegerOku(s.id);if(d===null)return null;r[s.id]=d;}
  return r;
}
function ggesGrupUret(cid,sorular,prefix){
  const el=document.getElementById(cid); el.innerHTML='';
  const et=[{deger:1,metin:"HiÃ§ tanÄ±mlamÄ±yor"},{deger:2,metin:"TanÄ±mlamÄ±yor"},{deger:3,metin:"KararsÄ±zÄ±m"},{deger:4,metin:"TanÄ±mlÄ±yor"},{deger:5,metin:"Tamamen tanÄ±mlÄ±yor"}];
  sorular.forEach(s=>{
    let r='';
    et.forEach(e=>{const id=`${prefix}_${s.id}_${e.deger}`;r+=`<label class="gges-radio-label" for="${id}"><input type="radio" name="${prefix}_${s.id}" id="${id}" value="${e.deger}"/><span>${e.metin}</span></label>`;});
    el.innerHTML+=`<div class="gges-madde"><div class="gges-sifat">${s.metin}</div><div class="gges-secenekler">${r}</div></div>`;
  });
}
function ggesGrupVeriTopla(sorular,prefix){
  const r={};
  for(const s of sorular){const v=document.querySelector(`input[name="${prefix}_${s.id}"]:checked`);if(!v)return null;r[`${prefix}_${s.id}`]=parseInt(v.value);}
  return r;
}

window.addEventListener('load',()=>{
  olcekUret('kimlik-sorular',KIMLIK_SORULARI,'kimlik',7);
  ggesGrupUret('gges-turk-sorular',GGES_SORULARI,'gges_turk');
  ggesGrupUret('gges-to-sorular',GGES_SORULARI,'gges_to');
  const rg=document.getElementById('dem-siyasi-konum-rg'); rg.innerHTML='';
  for(let i=1;i<=7;i++) rg.innerHTML+=`<input type="radio" name="dem-siyasi-konum" id="siyasi_${i}" value="${i}"/><label class="radio-label" for="siyasi_${i}">${i}</label>`;
  document.addEventListener('keydown',klavyeDinle);
});

function demografikDogrula(){
  const t=document.getElementById('dem-takma-isim').value.trim();
  const y=document.getElementById('dem-yas').value.trim();
  const c=document.getElementById('dem-cinsiyet').value;
  const g=document.getElementById('dem-gelir').value;
  const d=document.getElementById('dem-din').value;
  const dk=document.getElementById('dem-dindarlik').value;
  const sk=likertDegerOku('dem-siyasi-konum');
  const sb=document.getElementById('dem-siyasi-baglilik').value;
  if(!t||!y||!c||!g||!d||!dk||!sk||!sb){document.getElementById('dem-hata').style.display='block';return;}
  document.getElementById('dem-hata').style.display='none';
  veri.takma_isim=t;veri.yas=y;veri.cinsiyet=c;veri.gelir=g;veri.din=d;veri.dindarlik=dk;veri.siyasi_konum=sk;veri.siyasi_baglilik=sb;
  ekranGec('ekran-kimlik-aciklama');
}
function kimlikDogrula(){
  const s=olcekVeriTopla(KIMLIK_SORULARI);
  if(!s){document.getElementById('kimlik-hata').style.display='block';return;}
  document.getElementById('kimlik-hata').style.display='none';
  veri.kimlik=s; ekranGec('ekran-gges-aciklama');
}
function ggesTogrula(){
  const s=ggesGrupVeriTopla(GGES_SORULARI,'gges_turk');
  if(!s){document.getElementById('gges-turk-hata').style.display='block';return;}
  document.getElementById('gges-turk-hata').style.display='none';
  veri.gges_turk=s; ekranGec('ekran-gges-to');
}
function ggesToOgrula(){
  const s=ggesGrupVeriTopla(GGES_SORULARI,'gges_to');
  if(!s){document.getElementById('gges-to-hata').style.display='block';return;}
  document.getElementById('gges-to-hata').style.display='none';
  veri.gges_turkolmayan=s; ekranGec('ekran-aktor-aciklama');
}

function aktorZamanlamaBaslat(){
  aktorBaslangicZamani=Date.now();
  aktorTimerId=setTimeout(()=>{aktorZamanlamaDurdur();aktorKaydetVeGec(null);},AKTOR_SURE*1000);
}
function aktorZamanlamaDurdur(){
  if(aktorTimerId){clearTimeout(aktorTimerId);aktorTimerId=null;}
  if(aktorIntervalId){clearInterval(aktorIntervalId);aktorIntervalId=null;}
}
function aktorBaslat(){
  aktorSira=karistir(AKTOR_SENARYOLARI);aktorIndex=0;veri.aktor=[];
  veri.aktor_sirasi=aktorSira.map(s=>s.id);
  ekranGec('ekran-aktor'); aktorGorselGoster();
}
function aktorGorselGoster(){
  aktorYanitVerildi=false;
  const toplam=aktorSira.length, sn=aktorSira[aktorIndex];
  document.getElementById('aktor-ilerleme-metin').textContent=`Senaryo ${aktorIndex+1} / ${toplam}`;
  document.getElementById('aktor-ilerleme-ic').style.width=`${(aktorIndex/toplam)*100}%`;
  document.getElementById('aktor-gorsel').src=sn.gorsel;
  document.getElementById('tus-d-label').textContent=sn.mapping==="DK"?"Ã‡ekerim":"Ã‡ekmem";
  document.getElementById('tus-k-label').textContent=sn.mapping==="DK"?"Ã‡ekmem":"Ã‡ekerim";
  document.getElementById('tus-d').className='tus-kutu';
  document.getElementById('tus-k').className='tus-kutu';
  aktorZamanlamaBaslat();
}
function aktorKaydetVeGec(basin_tus){
  const sn=aktorSira[aktorIndex];
  const tepki=parseFloat(((Date.now()-aktorBaslangicZamani)/1000).toFixed(3));
  if(basin_tus==='D') document.getElementById('tus-d').className='tus-kutu secildi';
  else if(basin_tus==='K') document.getElementById('tus-k').className='tus-kutu secildi';
  veri.aktor.push({senaryo_id:sn.id,gosterim_sirasi:aktorIndex+1,mapping:sn.mapping,basin_tus:basin_tus!==null?basin_tus:"YOK",tepki_suresi:basin_tus!==null?tepki:AKTOR_SURE});
  aktorIndex++;
  setTimeout(()=>{
    if(aktorIndex<aktorSira.length) aktorGorselGoster();
    else ekranGec('ekran-bystander-aciklama');
  },400);
}

function bystanderBaslat(){
  bystanderSira=karistir(BYSTANDER_SENARYOLARI);bystanderIndex=0;veri.bystander=[];
  veri.bystander_sirasi=bystanderSira.map(s=>s.id);
  bystanderOncesiGoster();
}
function bystanderOncesiGoster(){
  const toplam=bystanderSira.length, sn=bystanderSira[bystanderIndex];
  document.getElementById('bys-ilerleme-metin').textContent=`Senaryo ${bystanderIndex+1} / ${toplam}`;
  document.getElementById('bys-ilerleme-ic').style.width=`${(bystanderIndex/toplam)*100}%`;
  document.getElementById('bys-gorsel-once').src=sn.once;
  bystanderOncesiAktif=true; bystanderSonrasiAktif=false;
  ekranGec('ekran-bystander-once');

  // SonrasÄ± gÃ¶rselini arka planda preload et
  const preload=new Image(); preload.src=sn.sonra;

  bystanderTimerId=setTimeout(()=>{
    bystanderOncesiAktif=false;
    const sonraImg=document.getElementById('bys-gorsel-sonra');
    fixationGoster('ekran-bystander-sonra', sonraImg, sn.sonra, ()=>{
      for(let i=1;i<=6;i++) document.getElementById(`bys-n-${i}`).classList.remove('secildi');
      bystanderSonrasiAktif=true;
    });
  }, BYSTANDER_ONCE_SURE);
}
function bystanderKaydetVeGec(puan){
  bystanderSonrasiAktif=false;
  for(let i=1;i<=6;i++) document.getElementById(`bys-n-${i}`).classList.remove('secildi');
  document.getElementById(`bys-n-${puan}`).classList.add('secildi');
  const sn=bystanderSira[bystanderIndex];
  veri.bystander.push({senaryo_id:sn.id,gosterim_sirasi:bystanderIndex+1,ahlak_puani:puan});
  bystanderIndex++;
  setTimeout(()=>{
    if(bystanderIndex<bystanderSira.length) bystanderOncesiGoster();
    else veriGonder();
  },300);
}

function klavyeDinle(e){
  const tus=e.key.toUpperCase();
  if(document.getElementById('ekran-aktor').classList.contains('aktif')){
    if((tus==='D'||tus==='K')&&!aktorYanitVerildi){
      aktorYanitVerildi=true; aktorZamanlamaDurdur(); aktorKaydetVeGec(tus);
    }
    return;
  }
  if(bystanderOncesiAktif){ e.preventDefault(); return; }
  if(bystanderSonrasiAktif){ const s=parseInt(e.key); if(s>=1&&s<=6) bystanderKaydetVeGec(s); }
}

function veriGonder(){
  ekranGec('ekran-gonderim');
  veri.zaman=new Date().toISOString(); veri.tarayici=navigator.userAgent;
  fetch(GOOGLE_SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(veri)})
  .then(()=>ekranGec('ekran-bitis')).catch(()=>ekranGec('ekran-bitis'));
}
</script>
</body>
</html>
